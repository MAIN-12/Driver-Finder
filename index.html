<!-- @format -->
<!DOCTYPE html>
<html lang="en">
	<head>
		<base target="_top" />
		<meta charset="utf-8" />
		<meta name="DriverFinder" content="width=device-width, initial-scale=1.0" />

		<title>Driver Finder Form</title>
		<link
			rel="stylesheet"
			href="https://fonts.googleapis.com/icon?family=Material+Icons"
		/>
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
		/>
		<link rel="stylesheet" href="CSS/style.css" />

		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"
			defer
		></script>

		<script async src="js/googlemaps.js"></script>
		<script
			async
			src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAAlmb_f3QrkP505PiLxQRfVjpQdBZumRg&callback=initMap"
		></script>
		<script src="https://unpkg.com/axios/dist/axios.min.js" defer></script>
		<script src="js/LogIn.js" defer></script>
		<script src="js/Index_EventListeners.js" defer></script>
		<script src="js/ResultsTable.js" defer></script>
		<script src="js/NewRoute.js" defer></script>
	</head>
	<body>
		<div id="Pre-loader" style="display: block"></div>
		<script async>
			window.addEventListener('load', () => {
				setTimeout(() => {
					document.getElementById('Pre-loader').style.display = 'none';
				}, 1000);
			});
		</script>

		<section name="main_page" class="wrapper">
			<div id="sbar" name="sbar" class="sidebar" style="display: block">
				<div class="center-align">
					<h2>Driver Finder</h2>
				</div>
				<form
					name="myForm"
					class="form formbox"
					style="padding-left: 0; padding-right: 0"
				>
					<ul class="collapsible">
						<li>
							<div class="collapsible-header">
								<i class="material-icons">map</i>Route Details
							</div>
							<div class="collapsible-body row">
								<div class="input-field col s7">
									<input name="fname" id="fname" type="text" class="validate" />
									<label for="fname">Route Name</label>
								</div>
								<div class="input-field col s5">
									<select name="state" id="state">
										<option for="state" value="" disabled selected>
											State
										</option>
										<option for="state" value="Florida">Florida</option>
										<option for="state" value="Indiana">Indiana</option>
										<option for="state" value="Pensilvania">Pensilvania</option>
										<option for="state" value="Tennessee">Tennessee</option>
									</select>
									<label for="state"></label>
								</div>
								<br />
								<p>
									<label>
										<input id="MonitorCheck" type="checkbox" />
										<span>Monitor</span>
									</label>
								</p>
								<p>
									<label>
										<input id="inactiveCheck" type="checkbox" />
										<span>Include inactive drivers</span>
									</label>
								</p>
							</div>
						</li>
						<li class="active">
							<div class="collapsible-header">
								<i class="material-icons">place</i>Address
							</div>
							<div class="collapsible-body">
								<div
									id="student1"
									class="row"
									style="margin-bottom: 5px; display: block"
								>
									<div class="input-field col s10" style="margin: 0 0 0 0">
										<input
											name="address1"
											id="address1"
											type="text"
											class="validate"
											required
										/>
										<label for="address1">Student 1 Address</label>
									</div>
									<div class="col s2">
										<a
											id="addStudent"
											type="button"
											class="btn-floating btn-small waves-effect waves-light blue"
										>
											<i class="material-icons">add</i>
										</a>
									</div>
									<br />
								</div>
								<div
									id="student2"
									class="row"
									style="margin-bottom: 5px; display: none"
								>
									<div class="input-field col s10" style="margin: 0">
										<input
											name="address2"
											id="address2"
											type="text"
											class="validate"
										/>
										<label for="address2">Student 2 Address</label>
									</div>
									<div class="col s2">
										<a
											id="removeStudent2"
											type="button"
											class="btn-floating btn-small waves-effect waves-light grey"
										>
											<i class="material-icons">delete</i>
										</a>
									</div>
									<br />
								</div>
								<div
									id="student3"
									class="row"
									style="margin-bottom: 5px; display: none"
								>
									<div class="input-field col s10" style="margin: 0">
										<input
											name="address3"
											id="address3"
											type="text"
											class="validate"
										/>
										<label for="address3">Student 3 Address</label>
									</div>
									<div class="col s2">
										<a
											id="removeStudent3"
											type="button"
											class="btn-floating btn-small waves-effect waves-light grey"
										>
											<i class="material-icons">delete</i>
										</a>
									</div>
									<br />
								</div>
								<div id="school" class="row" style="display: block">
									<div class="input-field col s10" style="margin: 0">
										<input
											name="schoolAddress"
											id="schoolAddress"
											type="text"
											class="validate"
											required
										/>
										<label for="schoolAddress">School Address</label>
									</div>
								</div>
							</div>
						</li>
						<li>
							<div class="collapsible-header">
								<i class="material-icons">access_time</i>Time
							</div>
							<div class="collapsible-body">
								<table>
									<thead>
										<th></th>
										<th class="center-align">Pick Up</th>
										<th class="center-align">Drop Off</th>
									</thead>
									<tbody>
										<tr>
											<td style="padding: 5px">Trip AM</td>
											<td style="padding: 0">
												<input
													id="pickUpAM"
													type="text"
													class="timepicker center-align test"
													placeholder="--:-- AM"
													style="border: none; margin: 0"
												/>
											</td>
											<td style="padding: 0">
												<input
													id="dropOffAM"
													type="text"
													class="timepicker center-align test"
													placeholder="--:-- AM"
													style="border: none; margin: 0"
												/>
											</td>
										</tr>
										<tr>
											<td style="padding: 5px">Trip PM</td>
											<td style="padding: 0">
												<input
													id="pickUpPM"
													type="text"
													class="timepicker center-align"
													placeholder="--:-- PM"
													style="border: none; margin: 0"
												/>
											</td>
											<td style="padding: 0">
												<input
													id="dropOffPM"
													type="text"
													class="timepicker center-align"
													placeholder="--:-- PM"
													style="border: none; margin: 0"
												/>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</li>

						<li>
							<div class="collapsible-header">
								<i class="material-icons">add_box</i>Add special trip
							</div>
							<div class="collapsible-body">
								<div class="input-field col s12">
									<select multiple>
										<option value="" disabled selected>Select days</option>
										<option value="0">Sunday</option>
										<option value="1">Monday</option>
										<option value="2">Tuesday</option>
										<option value="3">Wednesday</option>
										<option value="4">Thursday</option>
										<option value="5">Friday</option>
										<option value="6">Saturday</option>
									</select>
									<label>Special schedule</label>
								</div>

								<table>
									<thead>
										<th></th>
										<th class="center-align">Pick Up</th>
										<th class="center-align">Drop Off</th>
									</thead>
									<tbody>
										<tr>
											<td style="padding: 5px">Trip 3</td>
											<td style="padding: 0">
												<input
													id="sPickUp"
													type="text"
													class="timepicker center-align"
													placeholder="--:-- PM"
													style="border: none; margin: 0"
												/>
											</td>
											<td style="padding: 0">
												<input
													id="sDropOff"
													type="text"
													class="timepicker center-align"
													placeholder="--:-- PM"
													style="border: none; margin: 0"
												/>
											</td>
										</tr>
									</tbody>
								</table>
							</div>
						</li>
					</ul>

					<br />
					<div class="center-align">
						<button
							type="reset"
							class="waves-effect waves-light btn blue R20"
							value="Reset"
						>
							<i class="material-icons">replay</i>
						</button>
						<button
							class="btn waves-effect waves-light blue R20"
							type="submit"
							name="action"
						>
							Search <i class="material-icons right">search</i>
						</button>

						<button
							id="settings"
							type="button"
							class="waves-effect waves-light btn blue R20"
							value="Reset"
						>
							<i class="material-icons">settings</i>
						</button>
					</div>
				</form>
			</div>
			<div id="map" class="content"></div>
			<div id="result"></div>
		</section>

		<div class="btn-login">
			<a
				href="#login"
				class="btn-floating btn-large waves-effect waves-light modal-trigger"
				><i class="material-icons">person</i></a
			>
		</div>

		<div id="login" class="modal">
			<h5 class="modal-close">&#10005;</h5>
			<div class="modal-content">
				<h3 class="center">Please sign in</h3>

				<form
					name="loginForm"
					id="loginForm"
					class="form"
					style="padding-left: 30px; padding-right: 30px"
				>
					<div class="center-align">
						<div class="input-field box">
							<i class="material-icons prefix">person</i>
							<input
								type="text"
								id="userID"
								style="border: 0; margin-bottom: 0"
								placeholder="Username"
							/>
							<!-- <label for="userID">Username</label> -->
						</div>
						<div class="input-field box">
							<i class="material-icons prefix">lock</i>
							<input
								type="password"
								id="pass"
								style="border: 0; margin-bottom: 0"
								placeholder="Password"
							/>
							<!-- <label for="pass">Password</label> -->
							<!-- <span class="helper-text" data-error="wrong user name or password" data-success="Loged in">Helper text</span> -->
						</div>
						<p id="wronfPass" style="color: red; display: none">
							wrong user name or password
						</p>

						<!-- <label style="margin-left: 5px;">
                        <input type="checkbox" />
                        <span>Remenber me</span>
                    </label>
					<br /><br> -->

						<button
							name="login-submit"
							id="login-submit"
							class="btn blue"
							type="submit"
							style="border-radius: 20px; width: 100%"
						>
							Log in<i class="material-icons right"></i>
						</button>
						<br /><br />
						<a href="https://www.google.com/">Forgot password?</a>
						<br />
						Don't have an account? <a href="https://www.google.com/">Sign up</a>
					</div>
				</form>
			</div>
		</div>

		<div id="loadder" class="LogInBack" style="display: none">
			<div class="preloader-wrapper big active center-block loadder">
				<div class="modal-content spinner-layer spinner-blue-only">
					<div class="circle-clipper left">
						<div class="circle"></div>
					</div>
					<div class="gap-patch">
						<div class="circle"></div>
					</div>
					<div class="circle-clipper right">
						<div class="circle"></div>
					</div>
				</div>
			</div>
		</div>

		<script>
			//MAP INIT AND MARKERS
			// let key = 'AIzaSyAAlmb_f3QrkP505PiLxQRfVjpQdBZumRg';


			async function ADDRESS() {
				let A = ['address1', 'address2', 'address3', 'schoolAddress'];

				var L1 = await codeAddress('address1');
				var L2 = await codeAddress('address2');
				var L3 = await codeAddress('address3');
				var L4 = await codeAddress('schoolAddress');
				// let R=L1,L2

				setTimeout(function () {
					console.log('result PA | PB: ' + L1.location + ' | ' + L2.location);

					calculateAndDisplayRoute(
						directionsService,
						directionsDisplay,
						L1.location,
						L4.location
					);
				}, 1500);
				return L1.state;
			}

			let submitFlag = false;
			async function submitFun() {
				document.getElementById('loadder').style.display = 'block';

				let key = 1234;
				let bid = 'M122201';
				let routeName = document.getElementById('fname').value;
				let monitor = document.getElementById('MonitorCheck').checked;

				let includeInactive = document.getElementById('inactiveCheck').checked;

				let state = document.getElementById('state').value;

				let pickUpAM = document.getElementById('pickUpAM').value;
				let dropOffAM = document.getElementById('dropOffAM').value;
				let pickUpPM = document.getElementById('pickUpPM').value;
				let dropOffPM = document.getElementById('dropOffPM').value;

				let sPickUp = document.getElementById('sPickUp').value;
				let sDropOff = document.getElementById('sDropOff').value;
				let sDays = '';

				var RouteArray = [];
				let Address = [
					{
						id: 'address1',
						lable: 'A',
						input: document.getElementById('address1').value,
						formatted: '', //Address 1
						location: '',
					},
					{
						id: 'address2',
						lable: 'B',
						input: document.getElementById('address2').value,
						formatted: '', //Address 2
						location: '',
					},
					{
						id: 'address3',
						lable: 'C',
						input: document.getElementById('address2').value,
						formatted: '', //Address 3
						location: '',
					},
					{
						id: 'schoolAddress',
						lable: 'SC',
						input: document.getElementById('schoolAddress').value,
						formatted: '', //Address 4 (School)
						location: '',
					},
				];

				RouteArray.push(
					new route(
						routeName, //Route Name
						'Active', //Status
						'', //_MDD
						'AM', //AmPm  <==================
						'', //Days  <==================
						monitor, //Monitor
						'', //Passangers
						pickUpAM, //_PickUp <==================
						dropOffAM, //_DropOff <==================
						state, //State
						'', //City
						Address.filter((Data) => Data.formatted !== '')
					)
				);
				RouteArray.push(
					new route(
						routeName, //Route Name
						'Active', //Status
						'', //_MDD
						'PM', //AmPm  <==================
						'', //Days  <==================
						monitor, //Monitor
						'', //Passangers
						pickUpPM, //_PickUp <==================
						dropOffPM, //_DropOff <==================
						state, //State
						'', //City
						Address.filter((Data) => Data.formatted !== '')
					)
				);

				console.log('New Route', RouteArray);

				state = await ADDRESS();

				let url =
					'https://script.google.com/macros/s/AKfycbwXtBXQJNEJF8veBWDU1Q3nu5C06rG9TyNqGP9JR1ZiPqUgRRRw3eY2lIKULHUXyJr2/exec';
				url += `?key=${key}`;
				url += `&bid=${bid}`;
				url += includeInactive ? `` : '&active=true';
				url += `&state=${state}`;
				url += monitor ? `&monitor=true` : '';
				// url += `&latlong1=`;
				// url += `&monitor=true`;
				makeAPICall(url);
				// printResults((Drivers = testData()));
				submitFlag = false;
			}
		</script>
	</body>
</html>
